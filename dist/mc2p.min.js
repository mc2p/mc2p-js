!function(){var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global,e=function(t,e,a){this.MC2PPublicKey=t,this.token=e,this.API_URL="https://api.mychoice2pay.com/v1/pay/"+this.token+"/",this.API_HTML_URL=this.API_URL+"html/",this.API_CARD_URL=this.API_URL+"card/",this.API_SHARE_URL=this.API_URL+"share/",this.DIVVY_URL="https://pay.mychoice2pay.com/#/"+this.token+"/divvy",this.options={htmlDivId:a&&a.htmlDivId||"html-div",cardDivId:a&&a.cardDivId||"card-div",cardDataNameId:a&&a.cardDataNameId||"card-name",cardDataNumberId:a&&a.cardDataNumberId||"card-number",cardDataMonthId:a&&a.cardDataMonthId||"card-month",cardDataYearId:a&&a.cardDataYearId||"card-year",cardDataCVVId:a&&a.cardDataCVVId||"card-cvv"},this.gatewaysList=[],this.gatewaySelected=null},a=function(t,e){return function(a){t.innerHTML=a.html,t.style.visibility="visible",document.querySelector("#"+e.options.htmlDivId+" form").submit()}};e.prototype.__request=function(t,e,a,i){var s=new XMLHttpRequest;if(i&&(s.onreadystatechange=function(){4==s.readyState&&i(JSON.parse(s.responseText))}),s.open(t,e,!!i),s.setRequestHeader("Authorization","PublicKey "+this.MC2PPublicKey),s.setRequestHeader("Content-type","application/json"),s.send(a?JSON.stringify(a):null),!i)return JSON.parse(s.responseText)},e.prototype.getGateways=function(t){if(t){var e=this;return this.__request("GET",this.API_URL,null,function(a){e.gatewaysList=a.gateways,t(a)})}var a=this.__request("GET",this.API_URL,null,t);return this.gatewaysList=a.gateways,a},e.prototype.html=function(t,e){return this.__request("GET",this.API_HTML_URL+t+"/",null,e)},e.prototype.card=function(t,e,a){return this.__request("POST",this.API_CARD_URL+t+"/",e,a)},e.prototype.share=function(t,e){return this.__request("POST",this.API_SHARE_URL,t,e)},e.prototype.selectGateway=function(t){var e=document.getElementById(this.options.htmlDivId),i=document.getElementById(this.options.cardDivId);e.style.visibility="hidden",i.style.visibility="hidden";for(var s=0;s<this.gatewaysList.length;s++)if(this.gatewaysList[s].code===t){var o=this.gatewaysList[s];"html"===o.form?this.html(t,a(e,this)):"card"===o.form?i.style.visibility="visible":"shared"===o.form&&(document.location=this.DIVVY_URL),this.gatewaySelected=o;break}},e.prototype.sendCardDetails=function(t){var e={name:document.getElementById(this.options.cardDataNameId).value,number:document.getElementById(this.options.cardDataNumberId).value,month:document.getElementById(this.options.cardDataMonthId).value,year:document.getElementById(this.options.cardDataYearId).value,verification_value:document.getElementById(this.options.cardDataCVVId).value};return this.card(this.gatewaySelected.code,e,t)},"undefined"==typeof exports||exports.nodeType?t.MC2P=e:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=e),exports.MC2P=e)}();