!function(){var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global,e=function(t,e,i){this.MC2PPublicKey=t,this.token=e,this.API_URL="https://api.mychoice2pay.com/v1/pay/"+this.token+"/",this.API_HTML_URL=this.API_URL+"html/",this.API_CARD_URL=this.API_URL+"card/",this.API_ACCOUNT_URL=this.API_URL+"account/",this.API_SHARE_URL=this.API_URL+"share/",this.REDIRECT_URL="https://pay.mychoice2pay.com/#/"+this.token+"/redirect/",this.DIVVY_URL="https://pay.mychoice2pay.com/#/"+this.token+"/divvy",this.options={notRedirectHtml:i&&i.notRedirectHtml||!1,htmlDivId:i&&i.htmlDivId||"mc2p-html-div",cardDivId:i&&i.cardDivId||"mc2p-card-div",cardDataNameId:i&&i.cardDataNameId||"mc2p-card-name",cardDataNumberId:i&&i.cardDataNumberId||"mc2p-card-number",cardDataMonthId:i&&i.cardDataMonthId||"mc2p-card-month",cardDataYearId:i&&i.cardDataYearId||"mc2p-card-year",cardDataCVVId:i&&i.cardDataCVVId||"mc2p-card-cvv",iFrameId:i&&i.iFrameId||!1,iFrameGateways:i&&i.iFrameGateways||{},sendCardDetailsCallback:i&&i.sendCardDetailsCallback||void 0,sendAccountDetailsCallback:i&&i.sendAccountDetailsCallback||void 0},this.gatewaysList=[],this.gatewaySelected=null},r=function(e,i){return function(t){e.innerHTML=t.html,i.showId(i.options.htmlDivId)}},d=function(e,i){return function(t){e.innerHTML=t.html,i.showId(i.options.htmlDivId),document.querySelector("#"+i.options.htmlDivId+" form").submit()}};e.prototype.__request=function(t,e,i,a){var s=new XMLHttpRequest;if(a&&(s.onreadystatechange=function(){4==s.readyState&&a(JSON.parse(s.responseText))}),s.open(t,e,!!a),s.setRequestHeader("Authorization","PublicKey "+this.MC2PPublicKey),s.setRequestHeader("Content-type","application/json"),s.send(i?JSON.stringify(i):null),!a)return JSON.parse(s.responseText)},e.prototype.getGateways=function(e){if(e){var i=this;return this.__request("GET",this.API_URL,null,function(t){i.gatewaysList=t.gateways,e(t)})}var t=this.__request("GET",this.API_URL,null,e);return this.gatewaysList=t.gateways,t},e.prototype.html=function(t,e){return this.__request("GET",this.API_HTML_URL+t+"/",null,e)},e.prototype.card=function(t,e,i){return this.__request("POST",this.API_CARD_URL+t+"/",e,i)},e.prototype.account=function(t,e,i){return this.__request("POST",this.API_ACCOUNT_URL+t+"/",e,i)},e.prototype.share=function(t,e){return this.__request("POST",this.API_SHARE_URL,t,e)},e.prototype.selectGateway=function(t){var e=document.getElementById(this.options.htmlDivId),i=void 0;this.options.iFrameId&&(i=document.getElementById(this.options.iFrameId)),this.hideId(this.options.htmlDivId),this.hideId(this.options.cardDivId),this.options.iFrameId&&this.hideId(this.options.iFrameId);for(var a=0;a<this.gatewaysList.length;a++)if(this.gatewaysList[a].code===t){var s=this.gatewaysList[a];if("card"===s.form)this.showId(this.options.cardDivId);else if("html"===s.form)if(this.options.notRedirectHtml)this.html(t,d(e,this));else{var o=this.REDIRECT_URL+s.code;!i||s.code in this.options.iFrameGateways&&!this.options.iFrameGateways[s.code]?document.location=o:(i.setAttribute("src",o),this.showId(this.options.iFrameId))}else if("account"===s.form)this.html(t,r(e,this));else if("shared"===s.form)if(!i||s.code in this.options.iFrameGateways&&!this.options.iFrameGateways[s.code])document.location=this.DIVVY_URL;else{var n=this.DIVVY_URL+"/iframe";i.setAttribute("src",n),this.showId(this.options.iFrameId)}this.gatewaySelected=s;break}},e.prototype.sendCardDetails=function(t){t=t||this.options.sendCardDetailsCallback;var e={name:document.getElementById(this.options.cardDataNameId).value,number:document.getElementById(this.options.cardDataNumberId).value,month:document.getElementById(this.options.cardDataMonthId).value,year:document.getElementById(this.options.cardDataYearId).value,verification_value:document.getElementById(this.options.cardDataCVVId).value};return this.card(this.gatewaySelected.code,e,t)},e.prototype.sendAccountDetails=function(t){t=t||this.options.sendAccountDetailsCallback;var e=document.getElementById(this.options.htmlDivId);if(e){var i=e.getElementsByTagName("form");if(0<i.length){i=i[0];for(var a=new FormData(i).entries(),s={};;){var o=a.next();if(o.done)break;var n=o.value;s[n[0]]=n[1]}this.account(this.gatewaySelected.code,s,t)}}return!1},e.prototype.hideClass=function(t){for(var e=document.getElementsByClassName(t),i=0;i<e.length;i++)e[i].style.display="none"},e.prototype.showClass=function(t){for(var e=document.getElementsByClassName(t),i=0;i<e.length;i++)e[i].style.display="block"},e.prototype.hideId=function(t){var e=document.getElementById(t);e&&(e.style.display="none")},e.prototype.showId=function(t){var e=document.getElementById(t);e&&(e.style.display="block")},"undefined"==typeof exports||exports.nodeType?t.MC2P=e:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=e),exports.MC2P=e)}();